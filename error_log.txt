warning: unused imports: `DType`, `Device`, `Result as CandleResult`, and `Shape`
 --> src/runtime/mod.rs:6:19
  |
6 | use candle_core::{DType, Device, Result as CandleResult, Shape, Tensor};
  |                   ^^^^^  ^^^^^^  ^^^^^^^^^^^^^^^^^^^^^^  ^^^^^
  |
  = note: `#[warn(unused_imports)]` on by default

warning: use of deprecated method `inkwell::types::IntType::<'ctx>::ptr_type`: Starting from version 15.0, LLVM doesn't differentiate between pointer types. Use Context::ptr_type instead.
   --> src/compiler/codegen/builtins.rs:362:18
    |
362 |                 .ptr_type(inkwell::AddressSpace::default())
    |                  ^^^^^^^^
    |
    = note: `#[warn(deprecated)]` on by default

warning: unreachable statement
    --> src/compiler/semantics.rs:1162:21
     |
1160 |                       unreachable!("t0 verified as tensor above");
     |                       ------------------------------------------- any code following this expression is unreachable
1161 |                       // For reshape, return matched type with rank 0 (dynamic).
1162 | /                     if let Type::Tensor(inner, _) = t0 {
1163 | |                         return Ok(Type::Tensor(inner, 0));
1164 | |                     }
     | |_____________________^ unreachable statement
     |
     = note: `#[warn(unreachable_code)]` on by default

warning: variable does not need to be mutable
   --> src/runtime/mod.rs:901:21
    |
901 |                 let mut data_guard = data.lock().unwrap();
    |                     ----^^^^^^^^^^
    |                     |
    |                     help: remove this `mut`
    |
    = note: `#[warn(unused_mut)]` on by default

warning: field `param_counter` is never read
  --> src/compiler/codegen/mod.rs:27:16
   |
18 | pub struct CodeGenerator<'ctx> {
   |            ------------- field in this struct
...
27 |     pub(crate) param_counter: usize,
   |                ^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: `tl` (bin "tl") generated 5 warnings (run `cargo fix --bin "tl"` to apply 2 suggestions)
    Finished `release` profile [optimized] target(s) in 0.21s
     Running `target/release/tl run examples/train_add.tl`
Running file: "examples/train_add.tl"
PHI node entries do not match predecessors!
  %for_idx10 = phi i64 [ 0, %for_end ], [ %next_idx169, %for_end14 ]
label %for_end
label %for_body
PHI node entries do not match predecessors!
  %for_idx15 = phi i64 [ 0, %for_end9 ], [ %next_idx, %merge ]
label %for_end9
label %for_body8
define void @main() {
entry:
  %quotient = alloca i64, align 8
  %loss = alloca ptr, align 8
  %Y_flat = alloca ptr, align 8
  %logits_flat = alloca ptr, align 8
  %logits = alloca ptr, align 8
  %Y = alloca ptr, align 8
  %X = alloca ptr, align 8
  %target = alloca ptr, align 8
  %data = alloca ptr, align 8
  %diff = alloca i64, align 8
  %t5 = alloca float, align 4
  %t4 = alloca float, align 4
  %t3 = alloca float, align 4
  %t2 = alloca float, align 4
  %t1 = alloca float, align 4
  %t0 = alloca float, align 4
  %d5 = alloca float, align 4
  %d4 = alloca float, align 4
  %d3 = alloca float, align 4
  %d2 = alloca float, align 4
  %d1 = alloca float, align 4
  %d0 = alloca float, align 4
  %val_one = alloca float, align 4
  %val_zero = alloca float, align 4
  %val_pad = alloca float, align 4
  %val_eq = alloca float, align 4
  %val_plus = alloca float, align 4
  %val_j = alloca float, align 4
  %val_i = alloca float, align 4
  %r1 = alloca i64, align 8
  %sum = alloca i64, align 8
  %j = alloca i64, align 8
  %i = alloca i64, align 8
  %count = alloca float, align 4
  %total_loss = alloca ptr, align 8
  %epoch = alloca i64, align 8
  %epochs = alloca i64, align 8
  %lr = alloca float, align 4
  %model = alloca ptr, align 8
  %block_size = alloca i64, align 8
  %d_model = alloca i64, align 8
  %vocab_size = alloca i64, align 8
  store i64 13, ptr %vocab_size, align 8
  store i64 64, ptr %d_model, align 8
  store i64 6, ptr %block_size, align 8
  %vocab_size1 = load i64, ptr %vocab_size, align 8
  %d_model2 = load i64, ptr %d_model, align 8
  %static_call = call ptr @tl_GPT_new(i64 %vocab_size1, i64 %d_model2)
  store ptr %static_call, ptr %model, align 8
  store float 0x3F847AE140000000, ptr %lr, align 4
  store i64 200, ptr %epochs, align 8
  call void @tl_print_string(ptr @str_literal)
  %epochs3 = load i64, ptr %epochs, align 8
  br label %for_header

for_header:                                       ; preds = %merge175, %entry
  %for_idx = phi i64 [ 0, %entry ], [ %next_idx179, %merge175 ]
  %for_cond = icmp slt i64 %for_idx, %epochs3
  br i1 %for_cond, label %for_body, label %for_end

for_body:                                         ; preds = %for_header
  store i64 %for_idx, ptr %epoch, align 8
  %scalar_data = alloca float, align 4
  store float 0.000000e+00, ptr %scalar_data, align 4
  %scalar_shape = alloca i64, align 8
  %scalar_tensor = call ptr @tl_tensor_new(ptr %scalar_data, i64 0, ptr %scalar_shape)
  %scalar_data4 = alloca float, align 4
  store float 1.000000e+00, ptr %scalar_data4, align 4
  %scalar_shape5 = alloca i64, align 8
  %scalar_tensor6 = call ptr @tl_tensor_new(ptr %scalar_data4, i64 0, ptr %scalar_shape5)
  %pow_res = call ptr @tl_tensor_pow(ptr %scalar_tensor, ptr %scalar_tensor6)
  store ptr %pow_res, ptr %total_loss, align 8
  call void @tl_register_tensor(ptr @tensor_name.85, ptr %pow_res)
  store float 0.000000e+00, ptr %count, align 4
  br label %for_header7

for_end:                                          ; preds = %for_header
  call void @tl_print_string(ptr @str_literal.96)
  call void @tl_save_all_params(ptr @str_literal.97)
  call void @tl_print_string(ptr @str_literal.98)
  ret void

for_header7:                                      ; preds = %for_end14, %for_body
  %for_idx10 = phi i64 [ 0, %for_end ], [ %next_idx169, %for_end14 ]
  %for_cond11 = icmp slt i64 %for_idx10, 10
  br i1 %for_cond11, label %for_body8, label %for_end9

for_body8:                                        ; preds = %for_header7
  store i64 %for_idx10, ptr %i, align 8
  br label %for_header12

for_end9:                                         ; preds = %for_header7
  %epoch170 = load i64, ptr %epoch, align 8
  %divtmp = sdiv i64 %epoch170, 10
  store i64 %divtmp, ptr %quotient, align 8
  %quotient171 = load i64, ptr %quotient, align 8
  %multmp = mul i64 %quotient171, 10
  %epoch172 = load i64, ptr %epoch, align 8
  %eqtmp = icmp eq i64 %multmp, %epoch172
  br i1 %eqtmp, label %then173, label %else174

for_header12:                                     ; preds = %merge, %for_body8
  %for_idx15 = phi i64 [ 0, %for_end9 ], [ %next_idx, %merge ]
  %for_cond16 = icmp slt i64 %for_idx15, 10
  br i1 %for_cond16, label %for_body13, label %for_end14

for_body13:                                       ; preds = %for_header12
  store i64 %for_idx15, ptr %j, align 8
  %i17 = load i64, ptr %i, align 8
  %j18 = load i64, ptr %j, align 8
  %addtmp = add i64 %i17, %j18
  store i64 %addtmp, ptr %sum, align 8
  store i64 0, ptr %r1, align 8
  %i19 = load i64, ptr %i, align 8
  %scalar_data20 = alloca float, align 4
  %cast_i64_f32 = sitofp i64 %i19 to float
  store float %cast_i64_f32, ptr %scalar_data20, align 4
  %scalar_shape21 = alloca i64, align 8
  %scalar_tensor22 = call ptr @tl_tensor_new(ptr %scalar_data20, i64 0, ptr %scalar_shape21)
  %scalar_data23 = alloca float, align 4
  store float 1.000000e+00, ptr %scalar_data23, align 4
  %scalar_shape24 = alloca i64, align 8
  %scalar_tensor25 = call ptr @tl_tensor_new(ptr %scalar_data23, i64 0, ptr %scalar_shape24)
  %pow_res26 = call ptr @tl_tensor_pow(ptr %scalar_tensor22, ptr %scalar_tensor25)
  %get_res = call float @tl_tensor_get(ptr %pow_res26, i64 0)
  store float %get_res, ptr %val_i, align 4
  %j27 = load i64, ptr %j, align 8
  %scalar_data28 = alloca float, align 4
  %cast_i64_f3229 = sitofp i64 %j27 to float
  store float %cast_i64_f3229, ptr %scalar_data28, align 4
  %scalar_shape30 = alloca i64, align 8
  %scalar_tensor31 = call ptr @tl_tensor_new(ptr %scalar_data28, i64 0, ptr %scalar_shape30)
  %scalar_data32 = alloca float, align 4
  store float 1.000000e+00, ptr %scalar_data32, align 4
  %scalar_shape33 = alloca i64, align 8
  %scalar_tensor34 = call ptr @tl_tensor_new(ptr %scalar_data32, i64 0, ptr %scalar_shape33)
  %pow_res35 = call ptr @tl_tensor_pow(ptr %scalar_tensor31, ptr %scalar_tensor34)
  %get_res36 = call float @tl_tensor_get(ptr %pow_res35, i64 0)
  store float %get_res36, ptr %val_j, align 4
  store float 1.000000e+01, ptr %val_plus, align 4
  store float 1.100000e+01, ptr %val_eq, align 4
  store float 1.200000e+01, ptr %val_pad, align 4
  store float 0.000000e+00, ptr %val_zero, align 4
  store float 1.000000e+00, ptr %val_one, align 4
  %val_i37 = load float, ptr %val_i, align 4
  store float %val_i37, ptr %d0, align 4
  %val_plus38 = load float, ptr %val_plus, align 4
  store float %val_plus38, ptr %d1, align 4
  %val_j39 = load float, ptr %val_j, align 4
  store float %val_j39, ptr %d2, align 4
  %val_eq40 = load float, ptr %val_eq, align 4
  store float %val_eq40, ptr %d3, align 4
  %val_zero41 = load float, ptr %val_zero, align 4
  store float %val_zero41, ptr %d4, align 4
  %val_zero42 = load float, ptr %val_zero, align 4
  store float %val_zero42, ptr %d5, align 4
  %val_plus43 = load float, ptr %val_plus, align 4
  store float %val_plus43, ptr %t0, align 4
  %val_j44 = load float, ptr %val_j, align 4
  store float %val_j44, ptr %t1, align 4
  %val_eq45 = load float, ptr %val_eq, align 4
  store float %val_eq45, ptr %t2, align 4
  %val_zero46 = load float, ptr %val_zero, align 4
  store float %val_zero46, ptr %t3, align 4
  %val_zero47 = load float, ptr %val_zero, align 4
  store float %val_zero47, ptr %t4, align 4
  %val_pad48 = load float, ptr %val_pad, align 4
  store float %val_pad48, ptr %t5, align 4
  %sum49 = load i64, ptr %sum, align 8
  %getmp = icmp sge i64 %sum49, 10
  br i1 %getmp, label %then, label %else

for_end14:                                        ; preds = %for_header12
  %next_idx169 = add i64 %for_idx10, 1
  br label %for_header7

then:                                             ; preds = %for_body13
  %val_one50 = load float, ptr %val_one, align 4
  %val_one51 = load float, ptr %val_one, align 4
  store float %val_one51, ptr %d4, align 4
  %sum52 = load i64, ptr %sum, align 8
  %subtmp = sub i64 %sum52, 10
  store i64 %subtmp, ptr %diff, align 8
  %diff53 = load i64, ptr %diff, align 8
  %scalar_data54 = alloca float, align 4
  %cast_i64_f3255 = sitofp i64 %diff53 to float
  store float %cast_i64_f3255, ptr %scalar_data54, align 4
  %scalar_shape56 = alloca i64, align 8
  %scalar_tensor57 = call ptr @tl_tensor_new(ptr %scalar_data54, i64 0, ptr %scalar_shape56)
  %scalar_data58 = alloca float, align 4
  store float 1.000000e+00, ptr %scalar_data58, align 4
  %scalar_shape59 = alloca i64, align 8
  %scalar_tensor60 = call ptr @tl_tensor_new(ptr %scalar_data58, i64 0, ptr %scalar_shape59)
  %pow_res61 = call ptr @tl_tensor_pow(ptr %scalar_tensor57, ptr %scalar_tensor60)
  %get_res62 = call float @tl_tensor_get(ptr %pow_res61, i64 0)
  %diff63 = load i64, ptr %diff, align 8
  %scalar_data64 = alloca float, align 4
  %cast_i64_f3265 = sitofp i64 %diff63 to float
  store float %cast_i64_f3265, ptr %scalar_data64, align 4
  %scalar_shape66 = alloca i64, align 8
  %scalar_tensor67 = call ptr @tl_tensor_new(ptr %scalar_data64, i64 0, ptr %scalar_shape66)
  %scalar_data68 = alloca float, align 4
  store float 1.000000e+00, ptr %scalar_data68, align 4
  %scalar_shape69 = alloca i64, align 8
  %scalar_tensor70 = call ptr @tl_tensor_new(ptr %scalar_data68, i64 0, ptr %scalar_shape69)
  %pow_res71 = call ptr @tl_tensor_pow(ptr %scalar_tensor67, ptr %scalar_tensor70)
  %get_res72 = call float @tl_tensor_get(ptr %pow_res71, i64 0)
  store float %get_res72, ptr %d5, align 4
  %d473 = load float, ptr %d4, align 4
  %d474 = load float, ptr %d4, align 4
  store float %d474, ptr %t3, align 4
  %d575 = load float, ptr %d5, align 4
  %d576 = load float, ptr %d5, align 4
  store float %d576, ptr %t4, align 4
  br label %merge

else:                                             ; preds = %for_body13
  %sum77 = load i64, ptr %sum, align 8
  %scalar_data78 = alloca float, align 4
  %cast_i64_f3279 = sitofp i64 %sum77 to float
  store float %cast_i64_f3279, ptr %scalar_data78, align 4
  %scalar_shape80 = alloca i64, align 8
  %scalar_tensor81 = call ptr @tl_tensor_new(ptr %scalar_data78, i64 0, ptr %scalar_shape80)
  %scalar_data82 = alloca float, align 4
  store float 1.000000e+00, ptr %scalar_data82, align 4
  %scalar_shape83 = alloca i64, align 8
  %scalar_tensor84 = call ptr @tl_tensor_new(ptr %scalar_data82, i64 0, ptr %scalar_shape83)
  %pow_res85 = call ptr @tl_tensor_pow(ptr %scalar_tensor81, ptr %scalar_tensor84)
  %get_res86 = call float @tl_tensor_get(ptr %pow_res85, i64 0)
  %sum87 = load i64, ptr %sum, align 8
  %scalar_data88 = alloca float, align 4
  %cast_i64_f3289 = sitofp i64 %sum87 to float
  store float %cast_i64_f3289, ptr %scalar_data88, align 4
  %scalar_shape90 = alloca i64, align 8
  %scalar_tensor91 = call ptr @tl_tensor_new(ptr %scalar_data88, i64 0, ptr %scalar_shape90)
  %scalar_data92 = alloca float, align 4
  store float 1.000000e+00, ptr %scalar_data92, align 4
  %scalar_shape93 = alloca i64, align 8
  %scalar_tensor94 = call ptr @tl_tensor_new(ptr %scalar_data92, i64 0, ptr %scalar_shape93)
  %pow_res95 = call ptr @tl_tensor_pow(ptr %scalar_tensor91, ptr %scalar_tensor94)
  %get_res96 = call float @tl_tensor_get(ptr %pow_res95, i64 0)
  store float %get_res96, ptr %d4, align 4
  %val_pad97 = load float, ptr %val_pad, align 4
  %val_pad98 = load float, ptr %val_pad, align 4
  store float %val_pad98, ptr %d5, align 4
  %d499 = load float, ptr %d4, align 4
  %d4100 = load float, ptr %d4, align 4
  store float %d4100, ptr %t3, align 4
  %val_pad101 = load float, ptr %val_pad, align 4
  %val_pad102 = load float, ptr %val_pad, align 4
  store float %val_pad102, ptr %t4, align 4
  br label %merge

merge:                                            ; preds = %else, %then
  %tensor_data = alloca float, i64 6, align 4
  %d0103 = load float, ptr %d0, align 4
  %elem_ptr = getelementptr inbounds float, ptr %tensor_data, i64 0
  store float %d0103, ptr %elem_ptr, align 4
  %d1104 = load float, ptr %d1, align 4
  %elem_ptr105 = getelementptr inbounds float, ptr %tensor_data, i64 1
  store float %d1104, ptr %elem_ptr105, align 4
  %d2106 = load float, ptr %d2, align 4
  %elem_ptr107 = getelementptr inbounds float, ptr %tensor_data, i64 2
  store float %d2106, ptr %elem_ptr107, align 4
  %d3108 = load float, ptr %d3, align 4
  %elem_ptr109 = getelementptr inbounds float, ptr %tensor_data, i64 3
  store float %d3108, ptr %elem_ptr109, align 4
  %d4110 = load float, ptr %d4, align 4
  %elem_ptr111 = getelementptr inbounds float, ptr %tensor_data, i64 4
  store float %d4110, ptr %elem_ptr111, align 4
  %d5112 = load float, ptr %d5, align 4
  %elem_ptr113 = getelementptr inbounds float, ptr %tensor_data, i64 5
  store float %d5112, ptr %elem_ptr113, align 4
  %tensor_shape = alloca i64, i64 1, align 8
  %shape_ptr = getelementptr inbounds i64, ptr %tensor_shape, i64 0
  store i64 6, ptr %shape_ptr, align 8
  %new_tensor = call ptr @tl_tensor_new(ptr %tensor_data, i64 1, ptr %tensor_shape)
  store ptr %new_tensor, ptr %data, align 8
  call void @tl_register_tensor(ptr @tensor_name.86, ptr %new_tensor)
  %tensor_data114 = alloca float, i64 6, align 4
  %t0115 = load float, ptr %t0, align 4
  %elem_ptr116 = getelementptr inbounds float, ptr %tensor_data114, i64 0
  store float %t0115, ptr %elem_ptr116, align 4
  %t1117 = load float, ptr %t1, align 4
  %elem_ptr118 = getelementptr inbounds float, ptr %tensor_data114, i64 1
  store float %t1117, ptr %elem_ptr118, align 4
  %t2119 = load float, ptr %t2, align 4
  %elem_ptr120 = getelementptr inbounds float, ptr %tensor_data114, i64 2
  store float %t2119, ptr %elem_ptr120, align 4
  %t3121 = load float, ptr %t3, align 4
  %elem_ptr122 = getelementptr inbounds float, ptr %tensor_data114, i64 3
  store float %t3121, ptr %elem_ptr122, align 4
  %t4123 = load float, ptr %t4, align 4
  %elem_ptr124 = getelementptr inbounds float, ptr %tensor_data114, i64 4
  store float %t4123, ptr %elem_ptr124, align 4
  %t5125 = load float, ptr %t5, align 4
  %elem_ptr126 = getelementptr inbounds float, ptr %tensor_data114, i64 5
  store float %t5125, ptr %elem_ptr126, align 4
  %tensor_shape127 = alloca i64, i64 1, align 8
  %shape_ptr128 = getelementptr inbounds i64, ptr %tensor_shape127, i64 0
  store i64 6, ptr %shape_ptr128, align 8
  %new_tensor129 = call ptr @tl_tensor_new(ptr %tensor_data114, i64 1, ptr %tensor_shape127)
  store ptr %new_tensor129, ptr %target, align 8
  call void @tl_register_tensor(ptr @tensor_name.87, ptr %new_tensor129)
  %data130 = load ptr, ptr %data, align 8
  %dims_alloca = alloca [2 x i64], align 8
  %dim_ptr = getelementptr [2 x i64], ptr %dims_alloca, i64 0, i64 0
  store i64 1, ptr %dim_ptr, align 8
  %dim_ptr131 = getelementptr [2 x i64], ptr %dims_alloca, i64 0, i64 1
  store i64 6, ptr %dim_ptr131, align 8
  %dims_ptr = getelementptr [2 x i64], ptr %dims_alloca, i64 0, i64 0
  %reshape_dims_res = call ptr @tl_tensor_reshape_dims(ptr %data130, ptr %dims_ptr, i64 2)
  store ptr %reshape_dims_res, ptr %X, align 8
  call void @tl_register_tensor(ptr @tensor_name.88, ptr %reshape_dims_res)
  %target132 = load ptr, ptr %target, align 8
  %dims_alloca133 = alloca [2 x i64], align 8
  %dim_ptr134 = getelementptr [2 x i64], ptr %dims_alloca133, i64 0, i64 0
  store i64 1, ptr %dim_ptr134, align 8
  %dim_ptr135 = getelementptr [2 x i64], ptr %dims_alloca133, i64 0, i64 1
  store i64 6, ptr %dim_ptr135, align 8
  %dims_ptr136 = getelementptr [2 x i64], ptr %dims_alloca133, i64 0, i64 0
  %reshape_dims_res137 = call ptr @tl_tensor_reshape_dims(ptr %target132, ptr %dims_ptr136, i64 2)
  store ptr %reshape_dims_res137, ptr %Y, align 8
  call void @tl_register_tensor(ptr @tensor_name.89, ptr %reshape_dims_res137)
  %model138 = load ptr, ptr %model, align 8
  %X139 = load ptr, ptr %X, align 8
  %call_method = call ptr @tl_GPT_forward(ptr %model138, ptr %X139)
  store ptr %call_method, ptr %logits, align 8
  call void @tl_register_tensor(ptr @tensor_name.90, ptr %call_method)
  %logits140 = load ptr, ptr %logits, align 8
  %dims_alloca141 = alloca [2 x i64], align 8
  %dim_ptr142 = getelementptr [2 x i64], ptr %dims_alloca141, i64 0, i64 0
  store i64 6, ptr %dim_ptr142, align 8
  %dim_ptr143 = getelementptr [2 x i64], ptr %dims_alloca141, i64 0, i64 1
  store i64 13, ptr %dim_ptr143, align 8
  %dims_ptr144 = getelementptr [2 x i64], ptr %dims_alloca141, i64 0, i64 0
  %reshape_dims_res145 = call ptr @tl_tensor_reshape_dims(ptr %logits140, ptr %dims_ptr144, i64 2)
  store ptr %reshape_dims_res145, ptr %logits_flat, align 8
  call void @tl_register_tensor(ptr @tensor_name.91, ptr %reshape_dims_res145)
  %Y146 = load ptr, ptr %Y, align 8
  %dims_alloca147 = alloca [1 x i64], align 8
  %dim_ptr148 = getelementptr [1 x i64], ptr %dims_alloca147, i64 0, i64 0
  store i64 6, ptr %dim_ptr148, align 8
  %dims_ptr149 = getelementptr [1 x i64], ptr %dims_alloca147, i64 0, i64 0
  %reshape_dims_res150 = call ptr @tl_tensor_reshape_dims(ptr %Y146, ptr %dims_ptr149, i64 1)
  store ptr %reshape_dims_res150, ptr %Y_flat, align 8
  call void @tl_register_tensor(ptr @tensor_name.92, ptr %reshape_dims_res150)
  %logits_flat151 = load ptr, ptr %logits_flat, align 8
  %Y_flat152 = load ptr, ptr %Y_flat, align 8
  %ce_res = call ptr @tl_tensor_cross_entropy(ptr %logits_flat151, ptr %Y_flat152)
  store ptr %ce_res, ptr %loss, align 8
  call void @tl_register_tensor(ptr @tensor_name.93, ptr %ce_res)
  %loss153 = load ptr, ptr %loss, align 8
  call void @tl_tensor_backward(ptr %loss153)
  %model154 = load ptr, ptr %model, align 8
  %lr155 = load float, ptr %lr, align 4
  %call_method156 = call ptr @tl_GPT_step(ptr %model154, float %lr155)
  %model157 = load ptr, ptr %model, align 8
  %lr158 = load float, ptr %lr, align 4
  %call_method159 = call ptr @tl_GPT_step(ptr %model157, float %lr158)
  store ptr %call_method159, ptr %model, align 8
  %loss160 = load ptr, ptr %loss, align 8
  %old_val_to_free = load ptr, ptr %total_loss, align 8
  call void @tl_tensor_free(ptr %old_val_to_free)
  %loss161 = load ptr, ptr %loss, align 8
  store ptr %loss161, ptr %total_loss, align 8
  %load_for_free = load ptr, ptr %X, align 8
  call void @tl_tensor_free(ptr %load_for_free)
  %load_for_free162 = load ptr, ptr %loss, align 8
  call void @tl_tensor_free(ptr %load_for_free162)
  %load_for_free163 = load ptr, ptr %logits, align 8
  call void @tl_tensor_free(ptr %load_for_free163)
  %load_for_free164 = load ptr, ptr %target, align 8
  call void @tl_tensor_free(ptr %load_for_free164)
  %load_for_free165 = load ptr, ptr %Y_flat, align 8
  call void @tl_tensor_free(ptr %load_for_free165)
  %load_for_free166 = load ptr, ptr %Y, align 8
  call void @tl_tensor_free(ptr %load_for_free166)
  %load_for_free167 = load ptr, ptr %data, align 8
  call void @tl_tensor_free(ptr %load_for_free167)
  %load_for_free168 = load ptr, ptr %logits_flat, align 8
  call void @tl_tensor_free(ptr %load_for_free168)
  %next_idx = add i64 %for_idx15, 1
  br label %for_header12

then173:                                          ; preds = %for_end9
  call void @tl_print_string(ptr @str_literal.94)
  %epoch176 = load i64, ptr %epoch, align 8
  call void @tl_print_i64(i64 %epoch176)
  call void @tl_print_string(ptr @str_literal.95)
  %total_loss177 = load ptr, ptr %total_loss, align 8
  call void @tl_tensor_print(ptr %total_loss177)
  br label %merge175

else174:                                          ; preds = %for_end9
  br label %merge175

merge175:                                         ; preds = %else174, %then173
  %load_for_free178 = load ptr, ptr %total_loss, align 8
  call void @tl_tensor_free(ptr %load_for_free178)
  %next_idx179 = add i64 %for_idx, 1
  br label %for_header
}

thread 'main' panicked at src/main.rs:107:42:
called `Result::unwrap()` on an `Err` value: "Invalid generated function main"
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
